<!DOCTYPE html>
<html>
<head>
    <title>Open CMAP | Installation</title>
    <link rel="stylesheet" href="bundle.css">
    <link rel="stylesheet" href="animate.min.css">
</head>
<body class="bg-gray-100 h-screen relative">
    <!-- Installation -->
    <div id="multi-step-form" class="space-y-8">
        <!-- Welcome message -->
        <section class="step animate__animated fixed inset-0" id="step-1">
            <div class="items-center w-full px-5 py-12 mx-auto md:px-12 lg:px-16 max-w-7xl">
                <div class="flex w-full mx-auto">
                    <div class="inline-flex items-center m-auto align-middle">
                        <div class="max-w-6xl p-10 overflow-hidden bg-white rounded-3xl lg:p-20">
                            <div class="max-w-lg" id="failed">
                                <div>
                                    <p class="text-2xl font-medium tracking-tight text-black sm:text-4xl">
                                        Huhu... :( looks like App didn't run properly
                                    </p>
                                    <p class="max-w-xl mt-4 text-base tracking-tight text-gray-600">
                                        Don't be sad. you just need too run <span class="text-blue-400">Installation.bat</span> and follow the instruction. You can found this file on
                                    </p>

                                    <div class="p-2 rounded-lg bg-gray-500 text-white cursor-copy text-sm text-center my-4">
                                        C:\Users\{UserProfile}\AppData\Local\open_cmap\app-1.0.0\resources\app
                                    </div>

                                    <p class="max-w-xl text-base tracking-tight text-gray-600">
                                        A post-installer is a software component or script that runs after an application has been installed on a user's computer. Its primary purpose is to perform additional setup or configuration tasks that are required to prepare the application for use.
                                        <br>
                                        If you don't want to install on your local computer you can access online version from our web here
                                        <a href="https://open-cmap.fly.dev" class="text-sky-400 font-bold hover:underline decoration-wavy">Open CMAP</a>
                                    </p>
                                </div>

                                <div class="flex flex-col items-center justify-center gap-3 mt-10 lg:flex-row lg:justify-start">
                                    <button onclick="checkConnection()" class="items-center justify-center w-full px-6 py-2.5  text-center text-white duration-200 bg-black border-2 border-black rounded-full inline-flex hover:bg-transparent hover:border-black hover:text-black focus:outline-none lg:w-auto focus-visible:outline-black text-sm focus-visible:ring-black">
                                        Check App
                                    </button>
                                    <a href="https://github.com/ZakaCoding/open-cmap#readme" class="inline-flex items-center justify-center text-sm font-semibold text-black duration-200 hover:text-blue-500 focus:outline-none focus-visible:outline-gray-600">
                                        Learn more &nbsp; →
                                    </a>
                                </div>
                            </div>

                            <div id="success" class=" max-w-lg" hidden>
                                <h2 class="text-2xl font-medium tracking-tight text-black sm:text-4xl text-center">
                                    Your App Ready to use
                                </h2>
                                <p class="mt-4">
                                    This App will close in a second and run Open CMAP.
                                </p>
                                <div class="flex flex-col items-center justify-center gap-3 mt-10 lg:flex-row lg:justify-start">
                                    <a href="https://github.com/ZakaCoding/open-cmap#readme" class="items-center justify-center w-full px-6 py-2.5  text-center text-white duration-200 bg-black border-2 border-black rounded-full inline-flex hover:bg-transparent hover:border-black hover:text-black focus:outline-none lg:w-auto focus-visible:outline-black text-sm focus-visible:ring-black">
                                        Any Question, visit our github page &nbsp; →
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="step animate__animated fixed inset-0" id="step-2" hidden>
            <div class="relative items-center w-full px-5 py-12 mx-auto md:px-12 lg:px-16 max-w-7xl">
                <div class="flex w-full mx-auto">
                    <div class="inline-flex items-center m-auto align-middle">
                        <div class="max-w-6xl p-10 overflow-hidden bg-white rounded-3xl lg:p-20">
                            <div class="max-w-lg">
                                <div>
                                    <p class="text-2xl font-medium tracking-tight text-black sm:text-4xl">
                                        Check before start Installation
                                    </p>
                                    <ul class="gap-4 mt-6 space-y-3 list-none lg:gap-6" role="list">
                                        <li class="flex items-center">
                                            <!-- <svg xmlns="http://www.w3.org/2000/svg" class="bi bi-check-lg fill-green-400 h-7" viewBox="0 0 16 16">
                                                <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"/>
                                            </svg> -->
                                            <svg xmlns="http://www.w3.org/2000/svg" class="bi bi-x-lg fill-red-500 h-7" viewBox="0 0 16 16">
                                                <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                                            </svg>
                                            <span class="ml-3 text-gray-500"> Internet Connection </span>
                                        </li>
                                        <li class="flex items-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="bi bi-check-lg fill-green-400 h-7" viewBox="0 0 16 16">
                                                <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"/>
                                            </svg>
                                            <span class="ml-3 text-gray-500"> NodeJS </span>
                                        </li>
                                    </ul>
                                    <p class="my-4">
                                        We need 
                                    </p>
                                </div>
                                <div class="flex flex-col items-center justify-center gap-3 mt-10 lg:flex-row lg:justify-start">
                                    <button class="next-button items-center justify-center w-full px-6 py-2.5  text-center text-white duration-200 bg-black border-2 border-black rounded-full inline-flex hover:bg-transparent hover:border-black hover:text-black focus:outline-none lg:w-auto focus-visible:outline-black text-sm focus-visible:ring-black">
                                        Start Installation
                                    </button>
                                    <a href="https://github.com/ZakaCoding/open-cmap#readme" class="inline-flex items-center justify-center text-sm font-semibold text-black duration-200 hover:text-blue-500 focus:outline-none focus-visible:outline-gray-600">
                                        Learn more &nbsp; →
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script deffer>
        // JavaScript code for handling multi-step form logic with animations
        const form = document.getElementById("multi-step-form");
        const steps = form.querySelectorAll(".step");
        const nextButtons = form.querySelectorAll(".next-button");
        const prevButtons = form.querySelectorAll(".prev-button");

        let currentStep = 0;

        function showStep(step) {
            setTimeout(() => {
                step.removeAttribute("hidden");
                step.classList.add("animate__fadeInUp");
            }, 1000)
        }

        function hideStep(step) {
            step.classList.add("animate__fadeOutUp");

            setTimeout(() => {
                step.setAttribute("hidden", true);
            }, 700);
        }

        nextButtons.forEach((button, index) => {
            button.addEventListener("click", () => {
                hideStep(steps[currentStep]);
                currentStep = index + 1;
                showStep(steps[currentStep]);
            });
        });

        prevButtons.forEach((button, index) => {
            button.addEventListener("click", () => {
                hideStep(steps[currentStep]);
                currentStep = index - 1;
                showStep(steps[currentStep]);
            });
        });
    </script>

    <script>
        /**
         * Add global variable bellow
         */
        const { ipcRenderer } = require('electron');

        /**
         * Check App Connection
         */

         function checkConnection() {
            const serverURL = 'http://localhost:8000'; // Replace with the server URL

            fetch(serverURL)
            .then(response => {
                if (response.ok) {
                    // console.log('Server is running and responded with status code 200.');
                    document.querySelector('#success').removeAttribute('hidden');
                    document.querySelector('#failed').setAttribute('hidden', 'hidden');

                    setTimeout(() => {
                        // request complete
                        ipcRenderer.send('setup-complete');

                        // alert("Hell yeah!");
                    }, 2000);
                }
            })
            .catch(error => {
                // console.log('Server is not running or encountered an error', error);
                alert('Server is not running or encountered an error');
            });
         }
    </script>
</body>
</html>
